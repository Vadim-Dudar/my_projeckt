/*!
 * Likely 2.3.0 by Ilya Birman (ilyabirman.net)
 * Rewritten sans jQuery by Evgeny Steblinsky (volter9.github.io)
 * Supported by Ivan Akulov (iamakulov.com), Viktor Karpov (vitkarpov.com), and contributors
 * Inspired by Social Likes by Artem Sapegin (sapegin.me)
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.likely=e():t.likely=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=20)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"each",function(){return o}),n.d(e,"toArray",function(){return u}),n.d(e,"merge",function(){return c}),n.d(e,"extend",function(){return a}),n.d(e,"getDataset",function(){return s}),n.d(e,"bools",function(){return l}),n.d(e,"template",function(){return p}),n.d(e,"makeUrl",function(){return h}),n.d(e,"query",function(){return f}),n.d(e,"set",function(){return v}),n.d(e,"getDefaultUrl",function(){return d}),n.d(e,"isBrowserEnv",function(){return m});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i={yes:!0,no:!1},o=function(t,e){for(var n in t)t.hasOwnProperty(n)&&e(t[n],n)},u=function(t){return Array.prototype.slice.call(t)},c=function(){for(var t={},e=Array.prototype.slice.call(arguments),n=0;n<e.length;n++){var r=e[n];if(r)for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t},a=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},s=function(t){if("object"===r(t.dataset))return t.dataset;var e=void 0,n={},i=t.attributes,o=void 0,u=void 0,c=function(t){return t.charAt(1).toUpperCase()};for(e=i.length-1;e>=0;e--)o=i[e],o&&o.name&&/^data-\w[\w\-]*$/.test(o.name)&&(u=o.name.substr(5).replace(/-./g,c),n[u]=o.value);return n},l=function(t){var e={},n=s(t);for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];e[r]=i[o]||o}return e},p=function(t,e){return t?t.replace(/\{([^\}]+)\}/g,function(t,n){return n in e?e[n]:t}):""},h=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(e[n]=encodeURIComponent(e[n]));return p(t,e)},f=function t(e){var n=encodeURIComponent,t=[];for(var i in e)"object"!==r(e[i])&&t.push(n(i)+"="+n(e[i]));return t.join("&")},v=function(t,e,n){var r=e.split("."),i=null;r.forEach(function(e,n){"undefined"==typeof t[e]&&(t[e]={}),n!==r.length-1&&(t=t[e]),i=e}),t[i]=n},d=function(){var t=document.querySelector('link[rel="canonical"]');return t?t.href:window.location.href.replace(window.location.hash,"")},m="undefined"!=typeof window&&"undefined"!=typeof document&&document.createElement},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);n.d(e,"global",function(){return o}),n.d(e,"wrapSVG",function(){return a}),n.d(e,"createNode",function(){return s}),n.d(e,"getScript",function(){return l}),n.d(e,"getJSON",function(){return p}),n.d(e,"find",function(){return h}),n.d(e,"findAll",function(){return f}),n.d(e,"openPopup",function(){return v}),n.d(e,"createTempLink",function(){return d});var i={},o=r.isBrowserEnv?window:i,u=r.isBrowserEnv?document.createElement("div"):{},c=0;o.__likelyCallbacks={};var a=function(t){return'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path d="M'+t+'z"/></svg>'},s=function(t){return u.innerHTML=t,u.children[0]},l=function(t){var e=document.createElement("script"),n=document.head;e.type="text/javascript",e.src=t,n.appendChild(e),n.removeChild(e)},p=function(t,e){var n=encodeURIComponent("random_fun_"+ ++c),r=t.replace(/callback=(\?)/,"callback=__likelyCallbacks."+n);o.__likelyCallbacks[n]=e,l(r)},h=function(t,e){return(e||document).querySelector(t)},f=function(t,e){return Array.prototype.slice.call((e||document).querySelectorAll(t))},v=function(t,e,n,r){var i=Math.round(screen.width/2-n/2),o=0;screen.height>r&&(o=Math.round(screen.height/3-r/2));var u="left="+i+",top="+o+",width="+n+",height="+r+",personalbar=0,toolbar=0,scrollbars=1,resizable=1",c=window.open(t,e,u);return c?(c.focus(),c):(location.href=t,null)},d=function(t){var e=document.createElement("a");e.href=t,e.style="display: none",document.body.appendChild(e),setTimeout(function(){e.click(),document.body.removeChild(e)})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"likely",prefix:"likely__"}},function(t,e,n){"use strict";var r=n(9),i=n(0),o=n(10),u=n(11),c=n(12),a=n(13),s=n(14),l=n(15),p=n(16),h=n(17),f=n(18),v={facebook:o.a,gplus:u.a,linkedin:c.a,odnoklassniki:a.a,pinterest:s.a,telegram:l.a,twitter:p.a,vkontakte:h.a,whatsapp:f.a};n.i(i.each)(v,function(t,e){n.i(r.a)(t),t.name=e}),e.a=v},function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),u=o.bools,c=o.getDefaultUrl,a=o.merge,s=n(19).default,l=n(2).default,p=n(1),h=p.findAll,f=n(8).default,v=function(t,e){var n=e||{},r={counters:!0,timeout:1e3,zeroes:!1,title:document.title,wait:500,url:c()},i=t[l.name],o=a({},r,n,u(t));return i?i.update(o):t[l.name]=new s(t,o),i},d=function(){function t(){return r(this,t),console.warn("likely function is DEPRECATED and will be removed in 3.0. Use likely.initiate instead."),t.initiate.apply(t,arguments)}return i(t,null,[{key:"initate",value:function(){return console.warn("likely.initate function is DEPRECATED and will be removed in 3.0. Use likely.initiate instead."),t.initiate.apply(t,arguments)}},{key:"initiate",value:function(t,e){function n(){r.forEach(function(t){v(t,i)})}var r=void 0,i=void 0;Array.isArray(t)?(r=t,i=e):t instanceof Node?(r=[t],i=e):(r=h("."+l.name),i=t),n(),f.onUrlChange(n)}}]),t}();t.exports=d},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(1),o=n(0),u=n(2),c=n(7),a=n(3),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l='<span class="{className}">{content}</span>',p=function(){function t(e,i,u){r(this,t),this.widget=e,this.likely=i,this.options=n.i(o.merge)(u),this.init()}return s(t,[{key:"init",value:function(){this.detectService(),this.detectParams(),this.service&&(this.initHtml(),setTimeout(this.initCounter.bind(this),0))}},{key:"update",value:function(t){var e="."+u.default.prefix+"counter",r=n.i(i.findAll)(e,this.widget);n.i(o.extend)(this.options,n.i(o.merge)({forceUpdate:!1},t)),r.forEach(function(t){t.parentNode.removeChild(t)}),this.initCounter()}},{key:"detectService",value:function(){var t=this.widget,e=n.i(o.getDataset)(t).service;e||(e=Object.keys(a.a).filter(function(e){return t.classList.contains(e)})[0]),e&&(this.service=e,n.i(o.extend)(this.options,a.a[e]))}},{key:"detectParams",value:function(){var t=this.options,e=n.i(o.getDataset)(this.widget);if(e.counter){var r=parseInt(e.counter,10);isNaN(r)?t.counterUrl=e.counter:t.counterNumber=r}t.title=e.title||t.title,t.url=e.url||t.url}},{key:"initHtml",value:function(){var t=this.options,e=this.widget,r=e.innerHTML;e.addEventListener("click",this.click.bind(this)),e.classList.remove(this.service),e.className+=" "+this.className("widget");var u=n.i(o.template)(l,{className:this.className("button"),content:r}),c=n.i(o.template)(l,{className:this.className("icon"),content:n.i(i.wrapSVG)(t.svgIconPath)});e.innerHTML=c+u}},{key:"initCounter",value:function(){var t=this.options;t.counters&&t.counterNumber?this.updateCounter(t.counterNumber):t.counterUrl&&n.i(c.a)(this.service,t.url,t)(this.updateCounter.bind(this))}},{key:"className",value:function(t){var e=u.default.prefix+t;return e+" "+e+"_"+this.service}},{key:"updateCounter",value:function(t){var e=parseInt(t,10)||0,r=n.i(i.find)("."+u.default.name+"__counter",this.widget);r&&r.parentNode.removeChild(r);var c={className:this.className("counter"),content:e};e||this.options.zeroes||(c.className+=" "+u.default.prefix+"counter_empty",c.content=""),this.widget.appendChild(n.i(i.createNode)(n.i(o.template)(l,c))),this.likely.updateCounter(this.service,e)}},{key:"click",value:function(){var t=this.options;if(t.click.call(this)){var e=n.i(o.makeUrl)(t.popupUrl,{url:t.url,title:t.title});if(t.openPopup===!1)return n.i(i.createTempLink)(this.addAdditionalParamsToUrl(e)),!1;n.i(i.openPopup)(this.addAdditionalParamsToUrl(e),u.default.prefix+this.service,t.popupWidth,t.popupHeight)}return!1}},{key:"addAdditionalParamsToUrl",value:function(t){var e=n.i(o.query)(n.i(o.merge)(this.widget.dataset,this.options.data)),r=t.indexOf("?")===-1?"?":"&";return""===e?t:t+r+e}}]),t}();e.a=p},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(t){var e=[];return function(n){var i="undefined"==typeof n?"undefined":r(n);return"undefined"===i?t:void("function"===i?e.push(n):(t=n,e.forEach(function(t){t(n)})))}}},function(t,e,n){"use strict";var r=n(6),i=n(0),o=n(3),u={};e.a=function(t,e,c){u[t]||(u[t]={});var a=u[t],s=a[e];if(!c.forceUpdate&&s)return s;s=n.i(r.a)();var l=n.i(i.makeUrl)(c.counterUrl,{url:e});return o.a[t].counter(l,s,e),a[e]=s,s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=[],i=function(){r.forEach(function(t){t()})},o=function(){var t=window.history.pushState;window.history.pushState=function(){return setTimeout(i,0),t.apply(window.history,arguments)};var e=window.history.replaceState;window.history.replaceState=function(){return setTimeout(i,0),e.apply(window.history,arguments)},window.addEventListener("popstate",i)},u=!1,c={onUrlChange:function(t){u||(o(),u=!0),r.push(t)}};e.default=c},function(t,e,n){"use strict";var r=n(1),i=function(t,e){var i=this;n.i(r.getJSON)(t,function(t){try{var n="function"==typeof i.convertNumber?i.convertNumber(t):t;e(n)}catch(t){}})};e.a=function(t){t.counter=r.global.__likelyCounterMock||t.counter||i,t.click=t.click||function(){return!0}}},function(t,e,n){"use strict";e.a={counterUrl:"",convertNumber:function(t){return t.og_object.engagement.count},popupUrl:"https://www.facebook.com/sharer/sharer.php?u={url}",popupWidth:600,popupHeight:500,svgIconPath:"15.117 0H.883C.395 0 0 .395 0 .883v14.234c0 .488.395.883.883.883h7.663V9.804H6.46V7.39h2.086V5.607c0-2.066 1.262-3.19 3.106-3.19.883 0 1.642.064 1.863.094v2.16h-1.28c-1 0-1.195.48-1.195 1.18v1.54h2.39l-.31 2.42h-2.08V16h4.077c.488 0 .883-.395.883-.883V.883C16 .395 15.605 0 15.117 0"}},function(t,e,n){"use strict";e.a={counterUrl:"https://clients6.google.com/rpc",counter:function(t,e,n){var r=new XMLHttpRequest;r.open("POST",t),r.setRequestHeader("Content-Type","application/json"),r.addEventListener("load",function(){var t=JSON.parse(r.responseText)[0].result.metadata.globalCounts.count;e(t)}),r.send(JSON.stringify([{method:"pos.plusones.get",id:"p",params:{nolog:!0,id:n,source:"widget",userId:"@viewer",groupId:"@self"},jsonrpc:"2.0",key:"p",apiVersion:"v1"}]))},popupUrl:"https://plus.google.com/share?url={url}",popupWidth:700,popupHeight:500,svgIconPath:"0"}},function(t,e,n){"use strict";e.a={counterUrl:"",convertNumber:function(t){return t.count},popupUrl:"https://www.linkedin.com/shareArticle?mini=true&url={url}&title={title}",popupWidth:600,popupHeight:500,svgIconPath:"2.4,6h2.4v7.6H2.4V6z M3.6,2.2c0.8,0,1.4,0.6,1.4,1.4C4.9,4.3,4.3,5,3.6,5C2.8,5,2.2,4.3,2.2,3.6C2.2,2.8,2.8,2.2,3.6,2.2C3.6,2.2,3.6,2.2,3.6,2.2 M6.2,6h2.3v1h0C9,6.2,9.9,5.8,10.8,5.8c2.4,0,2.8,1.6,2.8,3.6v4.2h-2.4V9.9c0-0.9,0-2-1.2-2c-1.2,0-1.4,1-1.4,2v3.8H6.2V6z M13,0H3C1,0,0,1,0,3v10c0,2,1,3,3,3h10c2,0,3-1,3-3V3C16,1,15,0,13,0z"}},function(t,e,n){"use strict";var r=n(1),i=n(0),o={counterUrl:"https://connect.ok.ru/dk?st.cmd=extLike&ref={url}&uid={index}",counter:function(t,e){this.promises.push(e),n.i(r.getScript)(n.i(i.makeUrl)(t,{index:this.promises.length-1}))},promises:[],popupUrl:"https://connect.ok.ru/dk?st.cmd=WidgetSharePreview&service=odnoklassniki&st.shareUrl={url}",popupWidth:640,popupHeight:400,svgIconPath:"0"};n.i(i.set)(r.global,"ODKL.updateCount",function(t,e){o.promises[t](e)}),e.a=o},function(t,e,n){"use strict";e.a={counterUrl:"https://api.pinterest.com/v1/urls/count.json?url={url}&callback=?",convertNumber:function(t){return t.count},popupUrl:"https://pinterest.com/pin/create/button/?url={url}&description={title}",popupWidth:630,popupHeight:270,svgIconPath:"0"}},function(t,e,n){"use strict";e.a={popupUrl:"https://telegram.me/share/url?url={url}",popupWidth:600,popupHeight:500,svgIconPath:"6,11.960784l-1,-3l11,-8l-15.378,5.914c0,0 -0.672,0.23 -0.619,0.655c0.053,0.425 0.602,0.619 0.602,0.619l3.575,1.203l1.62,5.154l2.742,-2.411l-0.007,-0.005l3.607,2.766c0.973,0.425 1.327,-0.46 1.327,-0.46l2.531,-13.435l-10,11z"}},function(t,e,n){"use strict";e.a={popupUrl:"https://twitter.com/intent/tweet?url={url}&text={title}",popupWidth:600,popupHeight:450,click:function(){return/[\.\?:\-–—]\s*$/.test(this.options.title)||(this.options.title+=":"),!0},svgIconPath:"15.96 3.42c-.04.153-.144.31-.237.414l-.118.058v.118l-.59.532-.237.295c-.05.036-.398.21-.413.237V6.49h-.06v.473h-.058v.294h-.058v.296h-.06v.235h-.06v.237h-.058c-.1.355-.197.71-.295 1.064h-.06v.116h-.06c-.02.1-.04.197-.058.296h-.06c-.04.118-.08.237-.118.355h-.06c-.038.118-.078.236-.117.353l-.118.06-.06.235-.117.06v.116l-.118.06v.12h-.06c-.02.057-.038.117-.058.175l-.118.06v.117c-.06.04-.118.08-.177.118v.118l-.237.177v.118l-.59.53-.532.592h-.117c-.06.078-.118.156-.177.236l-.177.06-.06.117h-.118l-.06.118-.176.06v.058h-.118l-.06.118-.353.12-.06.117c-.078.02-.156.04-.235.058v.06c-.118.038-.236.078-.354.118v.058H8.76v.06h-.12v.06h-.176v.058h-.118v.06H8.17v.058H7.99v.06l-.413.058v.06h-.237c-.667.22-1.455.293-2.36.293h-.886v-.058h-.53v-.06H3.27v-.06h-.295v-.06H2.68v-.057h-.177v-.06h-.236v-.058H2.09v-.06h-.177v-.058h-.177v-.06H1.56v-.058h-.12v-.06l-.294-.06v-.057c-.118-.04-.236-.08-.355-.118v-.06H.674v-.058H.555v-.06H.437v-.058H.32l-.06-.12H.142v-.058c-.13-.08-.083.026-.177-.118H1.56v-.06c.294-.04.59-.077.884-.117v-.06h.177v-.058h.237v-.06h.118v-.06h.177v-.057h.118v-.06h.177v-.058l.236-.06v-.058l.236-.06c.02-.038.04-.078.058-.117l.237-.06c.02-.04.04-.077.058-.117h.118l.06-.118h.118c.036-.025.047-.078.118-.118V12.1c-1.02-.08-1.84-.54-2.303-1.183-.08-.058-.157-.118-.236-.176v-.117l-.118-.06v-.117c-.115-.202-.268-.355-.296-.65.453.004.987.008 1.354-.06v-.06c-.254-.008-.47-.08-.65-.175v-.058H2.32v-.06c-.08-.02-.157-.04-.236-.058l-.06-.118h-.117l-.118-.178h-.12c-.077-.098-.156-.196-.235-.294l-.118-.06v-.117l-.177-.12c-.35-.502-.6-1.15-.59-2.006h.06c.204.234.948.377 1.357.415v-.06c-.257-.118-.676-.54-.827-.768V5.9l-.118-.06c-.04-.117-.08-.236-.118-.354h-.06v-.118H.787c-.04-.196-.08-.394-.118-.59-.06-.19-.206-.697-.118-1.005h.06V3.36h.058v-.177h.06v-.177h.057V2.83h.06c.04-.118.078-.236.117-.355h.118v.06c.12.097.237.196.355.295v.118l.118.058c.08.098.157.197.236.295l.176.06.354.413h.118l.177.236h.118l.06.117h.117c.04.06.08.118.118.177h.118l.06.118.235.06.06.117.356.12.06.117.53.176v.06h.118v.058l.236.06v.06c.118.02.236.04.355.058v.06h.177v.058h.177v.06h.176v.058h.236v.06l.472.057v.06l1.417.18v-.237c-.1-.112-.058-.442-.057-.65 0-.573.15-.99.354-1.358v-.117l.118-.06.06-.235.176-.118v-.118c.14-.118.276-.236.414-.355l.06-.117h.117l.12-.177.235-.06.06-.117h.117v-.058H9.7v-.058h.177v-.06h.177v-.058h.177v-.06h.296v-.058h1.063v.058h.294v.06h.177v.058h.178v.06h.177v.058h.118v.06h.118l.06.117c.08.018.158.038.236.058.04.06.08.118.118.177h.118l.06.117c.142.133.193.163.472.178.136-.12.283-.05.472-.118v-.06h.177v-.058h.177v-.06l.236-.058v-.06h.177l.59-.352v.176h-.058l-.06.295h-.058v.117h-.06v.118l-.117.06v.118l-.177.118v.117l-.118.06-.354.412h-.117l-.177.236h.06c.13-.112.402-.053.59-.117l1.063-.353"}},function(t,e,n){"use strict";var r=n(1),i=n(0),o={counterUrl:"https://vk.com/share.php?act=count&url={url}&index={index}",counter:function(t,e){this.promises.push(e),n.i(r.getScript)(n.i(i.makeUrl)(t,{index:this.promises.length-1}))},promises:[],popupUrl:"https://vk.com/share.php?url={url}&title={title}",popupWidth:550,popupHeight:330,svgIconPath:"0"};n.i(i.set)(r.global,"VK.Share.count",function(t,e){o.promises[t](e)}),e.a=o},function(t,e,n){"use strict";e.a={popupUrl:"whatsapp://send?text={title}%0D%0A%0D%0A{url}",openPopup:!1,svgIconPath:"0"}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),o=n(2),u=n(0),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(){function t(e,n){r(this,t),this.container=e,this.options=n,this.countersLeft=0,this.buttons=[],this.number=0,this.init()}return c(t,[{key:"init",value:function(){n.i(u.toArray)(this.container.children).forEach(this.addButton.bind(this)),this.options.counters?(this.timer=setTimeout(this.appear.bind(this),this.options.wait),this.timeout=setTimeout(this.ready.bind(this),this.options.timeout)):this.appear()}},{key:"addButton",value:function(t){var e=new i.a(t,this,this.options);this.buttons.push(e),e.options.counterUrl&&this.countersLeft++}},{key:"update",value:function(t){(t.forceUpdate||t.url&&t.url!==this.options.url)&&(this.countersLeft=this.buttons.length,this.number=0,this.buttons.forEach(function(e){e.update(t)}))}},{key:"updateCounter",value:function(t,e){e&&(this.number+=e),this.countersLeft--,0===this.countersLeft&&(this.appear(),this.ready())}},{key:"appear",value:function(){this.container.classList.add(o.default.name+"_visible")}},{key:"ready",value:function(){this.timeout&&(clearTimeout(this.timeout),this.container.classList.add(o.default.name+"_ready"))}}]),t}();e.default=a},function(t,e,n){var r=n(4);window.addEventListener("load",function(){r.initiate()}),t.exports=r}])});

(function(){var a={getSelection:function(){var b=this.jquery?this[0]:this;return(("selectionStart" in b&&function(){var c=b.selectionEnd-b.selectionStart;return{start:b.selectionStart,end:b.selectionEnd,length:c,text:b.value.substr(b.selectionStart,c)}})||(document.selection&&function(){b.focus();var g=document.selection.createRange();if(g==null){return{start:0,end:b.value.length,length:0}}var d=b.createTextRange();var h=d.duplicate();d.moveToBookmark(g.getBookmark());h.setEndPoint("EndToStart",d);var k=h.text.length,c,j=k;for(c=0;c<k;c++){if(h.text.charCodeAt(c)==13){j--}}var f=g.text.length,e=f;for(c=0;c<f;c++){if(g.text.charCodeAt(c)==13){e--}}return{start:j,end:j+e,length:e,text:g.text}})||function(){return{start:0,end:b.value.length,length:0}})()},setSelection:function(f,b){var d=document.getElementById($(this).attr("id"));if(!d){return $(this)}else{if(d.setSelectionRange){d.focus();d.setSelectionRange(f,b)}else{if(d.createTextRange){var c=d.createTextRange();c.collapse(true);c.moveEnd("character",b);c.moveStart("character",f);c.select()}else{if(d.selectionStart){d.selectionStart=f;d.selectionEnd=b}}}}return $(this)},replaceSelection:function(){var b=this.jquery?this[0]:this;var c=arguments[0]||"";return(("selectionStart" in b&&function(){b.value=b.value.substr(0,b.selectionStart)+c+b.value.substr(b.selectionEnd,b.value.length);return this})||(document.selection&&function(){b.focus();document.selection.createRange().text=c;return this})||function(){b.value+=c;return this})()}};jQuery.each(a,function(b){jQuery.fn[b]=this})})();
/*!
	Autosize 4.0.0
	license: MIT
	http://www.jacklmoore.com/autosize
*/
(function(c,a){if(typeof define==="function"&&define.amd){define(["exports","module"],a)}else{if(typeof exports!=="undefined"&&typeof module!=="undefined"){a(exports,module)}else{var b={exports:{}};a(b.exports,b);c.autosize=b.exports}}})(this,function(d,b){var a=typeof Map==="function"?new Map():(function(){var n=[];var k=[];return{has:function m(p){return n.indexOf(p)>-1},get:function l(p){return k[n.indexOf(p)]},set:function o(p,q){if(n.indexOf(p)===-1){n.push(p);k.push(q)}},"delete":function e(q){var p=n.indexOf(q);if(p>-1){n.splice(p,1);k.splice(p,1)}}}})();var h=function h(e){return new Event(e,{bubbles:true})};try{new Event("test")}catch(f){h=function(k){var e=document.createEvent("Event");e.initEvent(k,true,false);return e}}function j(n){if(!n||!n.nodeName||n.nodeName!=="TEXTAREA"||a.has(n)){return}var e=null;var r=n.clientWidth;var k=null;function t(){var u=window.getComputedStyle(n,null);if(u.resize==="vertical"){n.style.resize="none"}else{if(u.resize==="both"){n.style.resize="horizontal"}}if(u.boxSizing==="content-box"){e=-(parseFloat(u.paddingTop)+parseFloat(u.paddingBottom))}else{e=parseFloat(u.borderTopWidth)+parseFloat(u.borderBottomWidth)}if(isNaN(e)){e=0}m()}function p(v){var u=n.style.width;n.style.width="0px";n.offsetWidth;n.style.width=u;n.style.overflowY=v}function s(v){var u=[];while(v&&v.parentNode&&v.parentNode instanceof Element){if(v.parentNode.scrollTop){u.push({node:v.parentNode,scrollTop:v.parentNode.scrollTop})}v=v.parentNode}return u}function l(){var x=n.style.height;var y=s(n);var u=document.documentElement&&document.documentElement.scrollTop;n.style.height="";var w=n.scrollHeight;var v=w+e;if(w===0){n.style.height=x;return}n.style.height=v+"px";r=n.clientWidth;y.forEach(function(z){z.node.scrollTop=z.scrollTop});if(u){document.documentElement.scrollTop=u}}function m(){l();var y=Math.round(parseFloat(n.style.height));var w=window.getComputedStyle(n,null);var x=w.boxSizing==="content-box"?Math.round(parseFloat(w.height)):n.offsetHeight;if(x!==y){if(w.overflowY==="hidden"){p("scroll");l();x=w.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(n,null).height)):n.offsetHeight}}else{if(w.overflowY!=="hidden"){p("hidden");l();x=w.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(n,null).height)):n.offsetHeight}}if(k!==x){k=x;var u=h("autosize:resized");try{n.dispatchEvent(u)}catch(v){}}}var o=function o(){if(n.clientWidth!==r){m()}};var q=(function(u){window.removeEventListener("resize",o,false);n.removeEventListener("input",m,false);n.removeEventListener("keyup",m,false);n.removeEventListener("autosize:destroy",q,false);n.removeEventListener("autosize:update",m,false);Object.keys(u).forEach(function(v){n.style[v]=u[v]});a["delete"](n)}).bind(n,{height:n.style.height,resize:n.style.resize,overflowY:n.style.overflowY,overflowX:n.style.overflowX,wordWrap:n.style.wordWrap});n.addEventListener("autosize:destroy",q,false);if("onpropertychange" in n&&"oninput" in n){n.addEventListener("keyup",m,false)}window.addEventListener("resize",o,false);n.addEventListener("input",m,false);n.addEventListener("autosize:update",m,false);n.style.overflowX="hidden";n.style.wordWrap="break-word";a.set(n,{destroy:q,update:m});t()}function g(k){var e=a.get(k);if(e){e.destroy()}}function c(k){var e=a.get(k);if(e){e.update()}}var i=null;if(typeof window==="undefined"||typeof window.getComputedStyle!=="function"){i=function(e){return e};i.destroy=function(e){return e};i.update=function(e){return e}}else{i=function(k,e){if(k){Array.prototype.forEach.call(k.length?k:[k],function(l){return j(l,e)})}return k};i.destroy=function(e){if(e){Array.prototype.forEach.call(e.length?e:[e],g)}return e};i.update=function(e){if(e){Array.prototype.forEach.call(e.length?e:[e],c)}return e}}b.exports=i});
(function(a){a.extend(a.fn,{caret:function(f,b){var d=this[0];if(d){if(typeof f=="undefined"){if(d.selectionStart){f=d.selectionStart;b=d.selectionEnd}else{if(document.selection){var e=this.val();var c=document.selection.createRange().duplicate();c.moveEnd("character",e.length);f=(c.text==""?e.length:e.lastIndexOf(c.text));c=document.selection.createRange().duplicate();c.moveStart("character",-e.length);b=c.text.length}}}else{var e=this.val();if(typeof f!="number"){f=-1}if(typeof b!="number"){b=-1}if(f<0){f=0}if(b>e.length){b=e.length}if(b<f){b=f}if(f>b){f=b}d.focus();if(d.selectionStart){d.selectionStart=f;d.selectionEnd=b}else{if(document.selection){var c=d.createTextRange();c.collapse(true);c.moveStart("character",f);c.moveEnd("character",b-f);c.select()}}}return{start:f,end:b}}}})})(jQuery);
var QuoteManager=function(){var b=false;var h="";$(".l-content-wrap").on("copy",".b-typo",function(i){b=true;d()});function d(){h=window.getSelection?window.getSelection().toString():document.selection.createRange().text}var a=$("textarea");var f=$.map(a,function(j){var i=$(j);return{el:i,val:i.val(),changed:function(){return this.val!=i.val()},update:function(){this.val=i.val()}}});f=$(f);setInterval(function(){g()},150);var e=null;a.on("paste",function(i){e=true});function g(){f.each(function(){if(e&&this.changed()){c(this);e=false}this.changed()?this.update():""})}function c(k){if(!b||h==""){return}var j=k.el.getSelection().end,i=h.length,n=j-i,m=k.el.val();if(m.substring(n,j).replace(/\s/g,"")!=h.replace(/\s/g,"")){return}var l="<blockquote>"+h+"</blockquote>";m=m.substring(0,n)+l+m.substring(j,m.length);k.el.val(m);k.el.caret(n+l.length,n+l.length)}};
var CommentsDom=Class.$extend({__init__:function(a){this.el=a;this.parseData()},parseItem:function(a){return{el:a,id:a.attr("id").replace("comment_","")}},item:function(a){return this.dict[a]},parseData:function(){this.items=this.el.find(".comment");this.data=$([]);this.dict={};this.items.each(function(a,b){b=$(b);var c=this.parseItem(b);this.dict[c.id]=c;this.data.push(c)}.bind(this))},updateComments:function(a){$(a.items).each(function(b,c){this.addComment(c)}.bind(this));this.parseData();if(a.addedId){MashUtil.scrollToEl(this.item(a.addedId).el)}},replaceCommentText:function(c,b){var a=this.item(c);$(a.el).find(".comment_text").html(b.html);this.dict[c]=this.parseItem($(a.el))},addComment:function(b){var a=null;if(b.parentId){var a=this.item(b.parentId).el;a.parent().after(b.html)}else{a=this.el;a.prepend(b.html)}this.updateComment(b.id)},updateComment:function(c){if(!c){return}var a=$("#comment_"+c);var b=this.parseItem(a);this.dict[b.id]=b;this.data.push(b)}});
var CommentsForm=BasicForm.$extend({onSubmit:function(){},__init__:function(a,b){b={items:{selector:"textarea",required:true}};this.placeholderTxt={ru:"Оставить комментарий…",uk:"Додати коментар…",en:"Write a comment…"}[window.LANG];this.$super(a,b);this.isPlaceholder=true;this.holder=this.el.parent();this.txt=this.el.find("textarea");this.txt.val(this.placeholderTxt);this.txt.addClass("placeholdered");this.is_full=false;this.is_autosized=false;window.COMMENTS_COUNT=window.COMMENTS_COUNT||0},createButton:function(){if(!this.btn){this.btn=new VButton2(this.btnSel||this.el.find(".form-button"))}this.btn.onClick=this._onSubmit.bind(this)},insert:function(a,b){a.append(this.el);this.initForm(b)},initForm:function(a){this.txt.val(this.placeholderTxt);this.txt.addClass("placeholdered");this.commentId=a;this.focus()},hide:function(){this.holder.append(this.el)},getText:function(a){return this.txt.val()},getEditedText:function(a){this.txt.val(a);if(window.COMMENTS_COUNT<1000){autosize(this.txt);autosize.update(this.txt)}},onFocus:function(){if(this.isPlaceholder){this.txt.val("")}this.el.addClass("focused");if(!this.is_full){this.el.addClass("__full");this.is_full=true}this.txt.removeClass("placeholdered");this.isPlaceholder=false;if(!this.is_autosized&&window.COMMENTS_COUNT<1000){autosize(this.txt);this.is_autosized=true}},onBlur:function(){this.el.removeClass("focused");this.setPlaceholder();if(this.isPlaceholder){this.el.removeClass("__full");this.is_full=false}},setPlaceholder:function(){if(this.isPlaceholder||this.txt.val()!=""){return}this.txt.val(this.placeholderTxt);this.txt.addClass("placeholdered");this.isPlaceholder=true},updateAuthor:function(a){this.el.find(".author").html(a)}});var FloatCommentsForm=Class.$extend({onSubmit:function(a){},onEdit:function(a){},__init__:function(a,b){this.el=a;this.dom=b;this.floatForm=new CommentsForm("#floatForm");this.floatForm.onSubmit=this._onSubmit.bind(this);this.cache={};$(document.body).click(this.onClick.bind(this))},_onSubmit:function(a){if(this.editMode){this.onEdit(a);this.editMode=false}else{this.onSubmit(a);if(this.cache[this.openedId]){delete this.cache[this.openedId]}}},edit:function(b,a){if(this.opened){if(b==this.openedId){return}this.close(b)}this.editMode=true;this.editedComment=a.parents(".comment");this.editedComment.hide();this.insertEditForm(b);params={id:b,csrfmiddlewaretoken:window.CSRF_TOKEN};$.post(window.CHANGE_URL,params,function(c){this.floatForm.getEditedText($.trim(c.content))}.bind(this),"json")},onClick:function(b){var a=$(b.target);if(!a.is(".answer-link")){return}var c=a.closest(".comment").attr("id").replace("comment_","");if(this.opened){this.close(c);if(c==this.openedId){return}}this.insertForm(c,a)},setOpener:function(b){if(!b){return}if(this.openerEl){this.cancelPrevOpener()}this.openerEl=b;b.addClass("open");var a={ru:"Не отвечать",uk:"Не відповідати",en:"Cancel"}[window.LANG];this.openerEl.html(a)},close:function(a){if(!this.opened){return}this.editMode=false;if(this.editedComment){this.editedComment.show()}this.floatForm.el.css("display","");this.cancelPrevOpener();this.opened=false;if(this.getText()!=""){this.cache[this.openedId]=this.getText()}this.floatForm.hide()},clear:function(){this.floatForm.clear();this.close()},enable:function(){this.floatForm.enable()},cancelPrevOpener:function(){if(!this.openerEl){return}this.openerEl.removeClass("open");var a={ru:"Ответить",uk:"Відповісти",en:"Reply"}[window.LANG];this.openerEl.html(a)},insertEditForm:function(b){var a=this.dom.item(b);this.openedId=b;a.el.before(this.floatForm.el);this.floatForm.el.show();this.floatForm.initForm(b);this.opened=true},insertForm:function(d,a){var b=this.dom.item(d);var c=b.el;this.setOpener(a);this.openedId=d;this.floatForm.insert(c,d);if(this.cache[this.openedId]){this.getText(this.cache[this.openedId])}this.opened=true;if(this.floatForm.txt.val()==this.floatForm.placeholderTxt){this.floatForm.txt.val("")}},getText:function(a){return this.floatForm.getText(a)},hideLoading:function(){this.floatForm.hideLoading()},showLoading:function(){this.floatForm.showLoading()},updateAuthor:function(a){this.floatForm.updateAuthor(a)}});
var Thread=Class.$extend({__init__:function(b,a){this.el=$(b);this.container=$(a);this.el_id="div."+b.id;this.el.find(".expand-thread").click(function(c){this.expandAll();return false}.bind(this))},expandAll:function(){var a=this.container.find(this.el_id);a.removeClass("ct-hidden");this.el.hide()}});var ThreadManager=Class.$extend({__init__:function(a,b){this.el=a;this.threads_objs={};this.threads=this.el.find(".thread-comments");$.each(this.threads,function(d,e){var c=new Thread(e,this.el);this.threads_objs[e.id]=c}.bind(this));this.expandThread(b)},expandThread:function(b){var g=parseInt(b);if(isNaN(g)){return}var f=this.el.find("#comment_"+b);var c=$(f).parent().attr("class");if(c=="b-comment"){return}try{var a=c.match(/th\-(\d+)/)[0];this.threads_objs[a].expandAll()}catch(d){return}}});
var CommentsManager=Class.$extend({__init__:function(){klass=this;this.el=$("#commentsList");this.lblCommentsCount=$("#lblCommentsCount");this.dom=new CommentsDom(this.el);this.QM=new QuoteManager();this.createForms();if(window.IS_MOBILE!="True"){this.menu=new FixedCommentsMenu()}if(window.USER_ID){var c=[];this.el.find(".g-new-comment").each(function(d){c.push(this.id.replace("comment_",""))});this.newCommentsManager=new NewCommentsManager(c)}this.complain=new ComplainDialog();this.complain.onChange=this.sentComplain.bind(this);this.bindComplain();this.sDialog=new BaseDialog("#subscribeDialog",{selector:"input",email:true,required:true});this.sDialog.onChange=this.sendSubscription.bind(this);this.btnSubscribe=$("#btnSubsribe").click(this.subscribe.bind(this));if(!window.USER_ID&&!window.loginManager){window.loginManager=new LoginManager()}var b=document.location.hash.replace("#","");this.threadManager=new ThreadManager(this.el,b);(new MultiButton(".b-comments .support")).onClick=this.vote.bind(this);new DeleteManager({selector:".comment",onEdit:this.onEditComment.bind(this)});this.wait_request=false;var a=this;this.el.on("click",".parent-link",function(){a.threadManager.expandThread($(this).attr("href").slice(1))});this.initParentTooltips()},initParentTooltips:function(){this.el.on("mouseenter",".parent-link",function(){var b=$(this);if(!b.attr("title")){var e=b.attr("href").replace("#","");var c=$("#comment_"+e);var a=c.find(".comment_text").clone();a.find("br").replaceWith("\n");var d=a.text().substring(0,400);b.attr("title",d)}})},createForms:function(){this.floatForm=new FloatCommentsForm(this.el,this.dom);this.floatForm.onSubmit=this.onSubmit.bind(this);this.floatForm.onEdit=this.onEdit.bind(this);this.defaultForm=new CommentsForm("#inlineForm");this.defaultForm.onSubmit=this.onSubmit.bind(this);this.forms=$([this.floatForm,this.defaultForm])},subscribe:function(a){a.stopPropagation();if(window.SUBSCRIBED){return this.sendSubscription(null,true)}if(!window.USER_ID){this.sDialog.show()}else{this.sendSubscription({})}},sendSubscription:function(b,a){var c=this.getParams("subscription");if(b){c=$.extend(c,b.form)}c.unsubscribe=a;$.post(window.COMMENTS_URL,c,function(e){if(!e.subscribed){this.btnSubscribe.removeClass("checked")}else{this.btnSubscribe.addClass("checked")}window.SUBSCRIBED=e.subscribed;this.sDialog.hide()}.bind(this),"json")},bindComplain:function(){$(document).click(function(b){var a=$(b.target);if(!a.is(".judge")||a.is(".disabled")){return}this.complainOpener=a;var c=this.getId(a);this.complain.show(this.dom.item(c))}.bind(this))},sentComplain:function(a){var b=this.getParams("complain");b=$.extend(b,a.form);b.id=a.item.id;$.post(window.COMMENTS_URL,b,function(c){if(c.error){MashUtil.showError(c.messages[0])}this.complain.hide();this.complainOpener.addClass("disabled")}.bind(this),"json")},getId:function(a){return a.parents(".comment").attr("id").replace("comment_","")},vote:function(b,a){this.commentId=this.getId(b);this.voteEl=b;if(window.USER_ID){this.doVote(a)}else{window.loginManager.showLogin({success:function(){this.doVote(a)}.bind(this),close:function(){this.voteEl.removeClass("pushed")}.bind(this)})}},doVote:function(d){var a=window.VOTE_URL?window.VOTE_URL:window.COMMENTS_URL;var e=d?"vote":"unlike";var c=d?"Поддержан":"Поддержать";var b=["","Поддержал:","Поддержали:"];if(window.LANG=="uk"){c=d?"Підтриманий":"Підтримати";b=["","Підтримав:","Підтримали:"]}else{if(window.LANG=="en"){c=d?"Liked":"Like";b=["","Liked by:","Liked by:"]}}var f=this.getParams(e);f.comment=this.commentId;$.post(a,f,"json").done(function(j){var i=this.dom.item(this.commentId);var k=i.el.find(".support").children("a");k.length>0?k.html(c):i.el.find("a.support").html(c);var l=i.el.find(".sup-users");var h=l.children("a").length;var g=l.children("span");if(d&&window.IS_MOBILE!="True"){if(h<1){l.html("<span>"+b[h+1]+"</span>");g=l.children("span")}g.after('<a user="'+window.USER_ID+'" href="'+j.url+'">'+j.username+"</a>")}else{if(h<=2){g.html(b[h-1])}l.find("a[user='"+window.USER_ID+"']").remove()}}.bind(this),"json")},updateComments:function(a){this.lblCommentsCount.html(a.count);this.dom.updateComments(a)},onSubmit:function(b){this.commentId=b;var a=this.floatForm;if(window.USER_ID){this.doSubmit()}else{window.loginManager.showLogin({success:function(){this.doSubmit();this.updateFormAuthor()}.bind(this),close:this.restoreForm.bind(this)});this.getActiveForm().hideLoading()}},onEditComment:function(c,b){var a=b.parents(".comment").find(".b-typo");this.floatForm.edit(c,a)},onEdit:function(c){this.commentId=c;var b=this.getParams("edit"),a=this.floatForm;b.id=c;b.text=a.getText();$.ajax({type:"POST",url:window.COMMENTS_URL,data:b,dataType:"json",async:false}).always(function(e){if(e.error){MashUtil.showError(e.messages[0]);return klass.restoreForm(a)}a.clear();klass.dom.replaceCommentText(c,e)})},updateFormAuthor:function(){this.forms.each(function(a,b){b.updateAuthor(window.authorHTML)})},getActiveForm:function(){return this.commentId?this.floatForm:this.defaultForm},doSubmit:function(){if(this.wait_request){return}this.wait_request=true;var a=this.getParams("add");a.parent=this.commentId;coment_form=this.getActiveForm();a.text=coment_form.getText();$.post(window.COMMENTS_URL,a,function(b){this.wait_request=false;if(b.error){MashUtil.showError(b.messages[0]);return this.restoreForm(coment_form)}coment_form.clear();this.updateComments(b)}.bind(this),"json")},restoreForm:function(a){if(window.USER_ID){this.updateFormAuthor()}if(!a){a=this.getActiveForm()}a.hideLoading();a.enable();a.focus()},getParams:function(b){var a={object_id:window.POST_ID,command:b,csrfmiddlewaretoken:window.CSRF_TOKEN};return a}});
var ComplainDialog=BaseDialog.$extend({__init__:function(){this.el=$("#complainDialog");this.$super(this.el,{selector:"textarea",required:true});this.avt=this.el.find(".avt");this.text=this.el.find(".comment_text")},getOnChangeParams:function(){var a=this.$super();a.item=this.item;return a},show:function(a){this.item=a;this.renderComment(a);this.toViewPort();this.$super()},renderComment:function(a){var b=a.el.find(".comment_text").html();b=MashUtil.getTrimedContent(b);this.text.html(b);this.avt.attr("src",a.el.find(".avatar img").attr("src"))}});
var FixedCommentsMenu=Class.$extend({__init__:function(){this.el=$("#fixedableMenuId");this.child=this.el.children("div.fixed-menu");this.elW=this.el.width();this.offsetTop=this.el.offset().top;this.isFixed=false;this.upPageEl=$("#upPageLnkId");setTimeout(function(){this.offsetTop=this.el.offset().top;this.elW=this.el.width();this.checkFixed()}.bind(this),5000);$(window).scroll(function(a){this.checkFixed()}.bind(this));$(window).resize(function(a){this.updateWindow();this.checkFixed()}.bind(this));this.upPageEl.click(function(a){$(window).scrollTop(0)})},updateWindow:function(){this.removeFixed();this.offsetTop=this.el.offset().top;this.elW=this.el.width();this.checkFixed()},checkFixed:function(){var a=(window.pageYOffset)?window.pageYOffset:document.documentElement.scrollTop;if(a>this.offsetTop){this.setFixed()}else{this.removeFixed()}},setFixed:function(){if(this.isFixed){return}this.el.addClass("__fixed");this.child.width(this.elW);this.isFixed=true},removeFixed:function(){if(!this.isFixed){return}this.el.removeClass("__fixed");this.isFixed=false}});var NewCommentsManager=Class.$extend({__init__:function(a){this.el=$("#newCommentsId");this.newComments=a;this.count=a.length;this.pointer=this.count;this.i=0;this.updateButton();this.el.click(function(b){this.someclick()}.bind(this));if(this.count&&window.IS_MOBILE!="True"&&window.IS_TABLET!="True"){this.hotkeysInit()}},someclick:function(a){if(this.count==1){return this.hideButton()}this.i++;this.count--;this.updateButton()},updateButton:function(){setTimeout(function(){this.el.html(this.count);this.el.attr("href","#"+this.newComments[this.i])}.bind(this),50)},hideButton:function(){this.el.parent().removeClass("__visible")},hotkeysInit:function(){manager=this;$.Shortcuts.add({type:"down",mask:"j, Shift+j",list:"jk",handler:function(){if(manager.i<manager.pointer-1){window.location.href="#"+manager.newComments[manager.i];manager.someclick();manager.last=manager.newComments[manager.i]}else{window.location.href="#"+manager.newComments[manager.pointer-1];manager.hideButton();manager.last=manager.newComments[manager.i-1]}}});$.Shortcuts.add({type:"down",mask:"k, Shift+k",list:"jk",handler:function(){if(manager.i>1){manager.i--;if(manager.last==manager.newComments[manager.i+1]){window.location.href="#"+manager.newComments[manager.i-1]}else{window.location.href="#"+manager.newComments[manager.i]}manager.last=manager.newComments[manager.i]}else{window.location.href="#"+manager.newComments[0];manager.last=manager.newComments[0]}}});$.Shortcuts.start("jk")}});
var DeleteManager=function(a){$(".l-content").on("click",a.selector+" .b-edit-delete a",c);function c(f){var d=$(f.target),g=d.closest(".comment").attr("id").replace("comment_","");if(d.hasClass("edit")){a.onEdit(g,d)}if(d.hasClass("delete")){if(window.IS_MOBILE=="True"&&!d.hasClass("__restore")&&!confirm("Удалить?")){return false}b(g,d)}}function b(g,e){var f={id:g,csrfmiddlewaretoken:window.CSRF_TOKEN},d=e.attr("restore");if(d){f.restore="true"}$.post(window.DELETE_ENTRY_URL,f,function(h){if(h.error){MashUtil.showError(h.messages[0])}else{if(!d){e.html("Вернуть").attr("restore",true).toggleClass("__restore")}else{e.html("").removeAttr("restore").toggleClass("__restore")}}},"json")}};
var SwitchArticles=Class.$extend({__init__:function(){this.el=$(".b-most-interesting .b-articles");this.head=this.el.find(".b-articles-switch");this.lists=this.el.find(".l-articles");this.setCurrentList=function(a){this.lists.addClass("hidden");this.lists.filter("#"+a).removeClass("hidden")};this.head.on("click","a",function(d){var c=$(d.currentTarget);var b=c.closest("li");var a=b.find("select");var e;if(a.length>=1){e=a.val()}else{e=c.data("articles")}if(!b.is(".current")){this.head.find("li.current").removeClass("current");b.addClass("current");this.setCurrentList(e)}return false}.bind(this));this.head.on("change","select",function(b){var a=$(b.currentTarget);var c=a.val();this.setCurrentList(c)}.bind(this))}});
var StarLikeManager=Class.$extend({__init__:function(){this.btnStar=$("#btnStar").click(this.star.bind(this));this.btnLike=$("#btnLike").click(this.like.bind(this))},getParams:function(b){var a={object_id:window.POST_ID,command:b,csrfmiddlewaretoken:window.CSRF_TOKEN};return a},star:function(b){var a=function(){b.stopPropagation();var c=this.getParams("star");c.check=!this.btnStar.is(".checked");$.post(window.COMMENTS_URL,c,function(e){if(!e.error){this.btnStar.find(".likely__counter").html(e.stars_count);this.btnStar.toggleClass("checked",c.check)}}.bind(this),"json")}.bind(this);if(!window.USER_ID){window.loginManager.showLogin({success:function(){a()}})}else{a()}},like:function(b){var a=function(){b.stopPropagation();var c=this.getParams("like");c.check=!this.btnLike.is(".checked");$.post(window.COMMENTS_URL,c,function(e){if(!e.error){this.btnLike.find(".likely__counter").html(e.likes_count);this.btnLike.toggleClass("checked",c.check)}}.bind(this),"json")}.bind(this);if(!window.USER_ID){window.loginManager.showLogin({success:function(){a()}})}else{a()}}});
var EventsManager=Class.$extend({__init__:function(){var a=this;a.POST_URL="/calendar/events-ajax/";a.btn=$(".big-button_events");a.btn.on("click",function(){if(!window.USER_ID){window.loginManager.showLogin({success:function(){a.eventsAction()}})}else{a.eventsAction()}})},eventsAction:function(){var a=this;data={csrfmiddlewaretoken:window.CSRF_TOKEN,user:window.USER_ID,event_id:window.EVENT_ID};$.post(this.POST_URL,data).done(function(b){if(b.type=="add"){var c=$("#ppl_me");if(!c.attr("title")){c.attr("title",b.name);a_link=c.children()[0];a_link.href=b.url;usr_img=$(a_link).children()[0];$(usr_img).attr({src:b.img_src,alt:b.name})}c.css("display","inline-block");$("#you_are").css("display","inline");a.btn.addClass("checked")}else{if(b.type=="remove"){$("#you_are").css("display","none");$("#ppl_me").css("display","none");a.btn.removeClass("checked")}}})}});
var FlowRightSideManager=Class.$extend({__init__:function(){this.el=$("#fixedableRightSide");if(this.el.length==0){return}this.startBlock=this.el.find(".g-clear");this.wrapper=this.el.find(".b-sticky-right-side");this.groups=this.el.find(".l-sticky-group");this.groupsCount=this.groups.length;this.groupsList={};$.each(this.groups,function(a,b){var c=new StickyGroup(b);this.groupsList[a]={id:a,obj:c,el:b}}.bind(this));this.currentGroup=null;this.getParams();setTimeout(function(){this.getParams();this.checkFixed()}.bind(this),5000);this.isFixed=false;this.isAbs=false;this.bindEvents();this.showFirstGroup()},showFirstGroup:function(){this.groupsList[0].obj.isShowed=true;this.groupsList[0].obj.resizeWindow(this.windowHeight);$(this.groupsList[0].el).show();this.currentGroup=this.groupsList[0]},getParams:function(){this.offsetTop=this.el.offset().top;this.elWidth=this.el.width();this.sideHeight=this.el.parent().parent().height();this.startTop=this.startBlock.offset().top;this.slideArea=this.offsetTop+this.sideHeight-this.startTop;this.windowHeight=$(window).height();this.distance=this.slideArea/this.groupsCount;this.is_short_area=this.distance<this.windowHeight;if(this.is_short_area){this.updateGroup(this.groupsCount-1,0)}this.lastGroupHeight=this.getGroupHeight(this.groupsCount-1);var a=this.lastGroupHeight+(this.is_short_area?this.getGroupHeight(0):0);this.limitTop=this.offsetTop+this.sideHeight-a},getGroupHeight:function(a){this.groupsList[a].obj.resizeWindow(this.windowHeight);return this.groupsList[a].obj.getHeight()},bindEvents:function(){$(window).scroll(function(a){this.checkFixed()}.bind(this));$(window).resize(function(a){this.updateGroups();this.updateWindow()}.bind(this));$(window).on("load",function(a){this.updateGroups();this.updateWindow()}.bind(this))},updateGroups:function(){this.windowHeight=$(window).height();$.each(this.groupsList,function(a,b){b.obj.resizeWindow(this.windowHeight)}.bind(this))},updateWindow:function(){this.removeFixed();this.getParams();this.checkFixed()},checkFixed:function(){if(this.limitTop-this.startTop<this.lastGroupHeight){return}var b=(window.pageYOffset)?window.pageYOffset:document.documentElement.scrollTop;if(b>this.limitTop){this.removeFixed();this.setAbsolute()}else{if(b>this.startTop&&b<this.limitTop){this.removeAbsolute();this.setFixed();var a=Math.floor((b-this.startTop)/this.distance);this.updateGroup(a,200)}else{this.removeAbsolute();this.removeFixed()}}},setAbsolute:function(){this.wrapper.addClass("__abs");this.wrapper.width(this.elWidth);this.isAbs=true},removeAbsolute:function(){if(!this.isAbs){return}this.wrapper.removeClass("__abs");this.isAbs=false},setFixed:function(){if(this.isFixed){return}this.wrapper.addClass("__fixed");this.wrapper.width(this.elWidth);this.isFixed=true},hideGroup:function(){if(this.is_short_area){return}if(this.currentGroup){$(this.currentGroup.el).fadeOut(200);this.currentGroup.obj.isShowed=false}this.currentGroup=null},updateGroup:function(a,b){if(this.is_short_area){a=this.groupsCount-1}if(this.currentGroup==this.groupsList[a]){return}if(this.currentGroup&&!this.is_short_area){$(this.currentGroup.el).fadeOut(b)}this.currentGroup=this.groupsList[a];$(this.currentGroup.el).delay(b).fadeIn(b);setTimeout(function(){this.currentGroup.obj.isShowed=true;this.currentGroup.obj.resizeWindow(this.windowHeight)}.bind(this),b)},removeFixed:function(){if(!this.isFixed){return}this.wrapper.removeClass("__fixed");this.isFixed=false}});var StickyGroup=Class.$extend({__init__:function(a){this.el=$(a);this.wH=$(window).height();this.elH=this.el.height();this.items=this.el.find(".l-sticky-item");this.num=this.items.length;this.isShowed=false},updateItems:function(){this.items.removeClass("__dn");this.elH=this.el.height();$.each(this.items,function(a,b){if(a==this.num-1){return}b=$(b);if(this.wH<this.elH){this.elH=this.elH-b.height();b.addClass("__dn")}}.bind(this))},setStyles:function(){this.el.css({display:"block",position:"absolute",visibility:"hidden"})},removeStyles:function(){this.el.css({display:"none",position:"relative",visibility:"visible"})},resizeWindow:function(a){this.wH=a;if(!this.isShowed){this.setStyles()}this.updateItems();if(!this.isShowed){this.removeStyles()}},getHeight:function(){return this.elH}});
